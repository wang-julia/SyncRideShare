{"version":3,"sources":["../../../src/better-auth/types.ts"],"sourcesContent":["import type { BetterAuthPlugin } from 'better-auth'\n\nexport type InnerSession = {\n  user: {\n    id: string\n    name?: string | null\n    email?: string | null\n    organizationId?: string | null\n  }\n}\n\n/**\n * The session type returned by getSessionFromCtx in Better Auth.\n * Contains both session and user information.\n */\nexport type BetterAuthSessionResult = {\n  session: {\n    id: string\n    userId: string\n    activeOrganizationId?: string\n    [key: string]: unknown\n  }\n  user: {\n    id: string\n    name?: string | null\n    email?: string | null\n    [key: string]: unknown\n  }\n}\n\n/**\n * Error response format for Better Auth endpoints.\n * Consistent format: { error: { code, message, details? } }\n */\nexport type FlowgladEndpointError = {\n  code: string\n  message: string\n  details?: unknown\n}\n\nexport type FlowgladBetterAuthPluginOptions = {\n  /**\n   * Optional API key. If not provided, reads from FLOWGLAD_SECRET_KEY environment variable.\n   */\n  apiKey?: string\n  /**\n   * Optional base URL for Flowglad API. Defaults to https://app.flowglad.com\n   */\n  baseURL?: string\n\n  /**\n   * Type of customer to use. Defaults to \"user\".\n   *\n   * External ID resolution (via `getExternalId` / billing endpoints):\n   * - \"user\": Uses `session.session.userId`\n   * - \"organization\": Uses `session.session.activeOrganizationId` (requires org plugin + active org selected)\n   *\n   * Customer auto-creation hooks:\n   * - For sign-up, the created user's `id` is used.\n   * - For organization creation, the created organization's `id` is used.\n   */\n  customerType?: 'user' | 'organization'\n\n  /**\n   * Optional function to extract customer info from Better Auth session.\n   * If not provided, defaults to extracting from session.user based on customerType.\n   *\n   * This gives you full control over:\n   * - Which ID to use (user.id, org.id, custom mapping)\n   * - How to get name/email (from user, org, or custom logic)\n   */\n  getCustomer?: (session: InnerSession) => Promise<{\n    externalId: string\n    name: string\n    email: string\n  }>\n\n  /**\n   * Optional callback invoked when Flowglad customer auto-creation fails inside\n   * the Better Auth `after` hooks (sign-up / organization creation).\n   *\n   * If not provided, failures are logged with `console.error` and the auth\n   * operation continues (best-effort).\n   */\n  onCustomerCreateError?: (params: {\n    hook: 'afterSignUp' | 'afterOrganizationCreate'\n    customerType: 'user' | 'organization'\n    session: InnerSession\n    error: unknown\n  }) => void | Promise<void>\n}\n\nexport type FlowgladBetterAuthPlugin = BetterAuthPlugin\n"],"mappings":";;;;;;;;;;;;;;AAAA;AAAA;","names":[]}