{"version":3,"sources":["../../src/types.ts"],"sourcesContent":["export interface CoreCustomerUser {\n  externalId: string\n  name: string\n  email: string\n}\n\nexport type GetRequestingCustomer = () => Promise<CoreCustomerUser>\n\nexport interface FlowgladServerSessionParamsCore {\n  getRequestingCustomer?: GetRequestingCustomer\n  baseURL?: string\n  apiKey?: string\n}\n\ninterface SupabaseClient {\n  auth: {\n    getUser: () => Promise<\n      | {\n          data: {\n            user: {\n              id: string\n              email?: string\n              phone?: string\n              user_metadata: {\n                [key: string]: any\n              }\n            }\n          }\n        }\n      | {\n          data: {\n            user: null\n          }\n          error: any\n        }\n    >\n  }\n}\n\nexport interface SupabaseFlowgladServerSessionParams\n  extends FlowgladServerSessionParamsCore {\n  supabaseAuth: {\n    client: () => Promise<SupabaseClient> | SupabaseClient\n  }\n}\n\ninterface NextAuthSession {\n  user: {\n    name?: string | null\n    email?: string | null\n    image?: string | null\n  }\n}\n\nexport interface NextjsAuthFlowgladServerSessionParams\n  extends FlowgladServerSessionParamsCore {\n  nextAuth: {\n    auth: () => Promise<NextAuthSession | null>\n    customerFromAuth?: (\n      session: NextAuthSession\n    ) => Promise<CoreCustomerUser | null>\n  }\n}\n\ninterface BetterAuthSession {\n  user: {\n    id: string\n    name?: string | null | undefined\n    email?: string | null | undefined\n    image?: string | null | undefined\n  }\n}\n\nexport interface BetterAuthFlowgladServerSessionParams\n  extends FlowgladServerSessionParamsCore {\n  betterAuth: {\n    /**\n     * the getSession function from the BetterAuth client.\n     */\n    getSession: () => Promise<BetterAuthSession | null>\n    /**\n     * Extracts the customer parameters from the session object.\n     */\n    customerFromSession?: (\n      session: BetterAuthSession\n    ) => Promise<CoreCustomerUser | null>\n  }\n}\n\nexport interface BaseFlowgladServerSessionParams\n  extends FlowgladServerSessionParamsCore {\n  getRequestingCustomer: GetRequestingCustomer\n}\n\ninterface ClerkEmailAddress {\n  emailAddress: string\n}\n\ninterface ClerkUser {\n  id: string\n  firstName: string | null\n  lastName: string | null\n  username: string | null\n  emailAddresses: ClerkEmailAddress[]\n}\n\nexport interface ClerkFlowgladServerSessionParams\n  extends FlowgladServerSessionParamsCore {\n  clerk: {\n    currentUser: () => Promise<ClerkUser | null>\n    customerFromCurrentUser?: (\n      currentUser: ClerkUser\n    ) => Promise<CoreCustomerUser | null>\n  }\n}\n\nexport interface ScopedFlowgladServerParams {\n  /**\n   * The customer ID from YOUR app's database (e.g., user.id or organization.id).\n   * This is NOT Flowglad's customer IDâ€”Flowglad uses this external ID to identify\n   * and create customers in its system.\n   *\n   * For B2C apps: Use your user.id\n   * For B2B apps: Use your organization.id or team.id\n   */\n  customerExternalId: string\n  baseURL?: string\n  apiKey?: string\n  /**\n   * Handler to retrieve customer details from your database.\n   *\n   * This function is called when attempting to create a customer record in Flowglad\n   * for a customer that doesn't yet exist. Implement this to fetch the customer's\n   * name and email from your database based on their customer ID.\n   *\n   * @param customerExternalId - The external customer ID from YOUR system (not Flowglad's)\n   * @returns Promise resolving to an object containing the customer's name and email\n   *\n   * @example\n   *\n   * new FlowgladServer({\n   *   customerExternalId: 'user-123',\n   *   getCustomerDetails: async (customerExternalId) => {\n   *     const user = await db.users.findOne({ id: customerExternalId })\n   *     return {\n   *       name: user.name,\n   *       email: user.email,\n   *     }\n   *   },\n   * })\n   *    */\n  getCustomerDetails: (customerExternalId: string) => Promise<{\n    name: string\n    email: string\n  }>\n}\n\nexport type FlowgladServerSessionParams =\n  | SupabaseFlowgladServerSessionParams\n  | NextjsAuthFlowgladServerSessionParams\n  | ClerkFlowgladServerSessionParams\n  | BetterAuthFlowgladServerSessionParams\n  | BaseFlowgladServerSessionParams\n  | ScopedFlowgladServerParams\n"],"mappings":";;;;;;;;;;;;;;AAAA;AAAA;","names":[]}